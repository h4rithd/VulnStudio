import React from 'react';
import { Check } from 'lucide-react';
import { cn } from '@/lib/utils';
import { Spinner } from '@/components/ui/spinner';
import { VulnDBItem } from '../types/vulnerability.types';

interface SearchResultsProps {
  loading: boolean;
  results: VulnDBItem[];
  selectedItem: VulnDBItem | null;
  onItemSelect: (item: VulnDBItem) => void;
}

const SearchResults: React.FC<SearchResultsProps> = ({
  loading,
  results,
  selectedItem,
  onItemSelect,
}) => {
  // Safe guard against undefined results
  const safeResults = Array.isArray(results) ? results : [];
  
  if (loading) {
    return (
      <div className="py-6 text-center">
        <div className="flex justify-center">
          <Spinner size="md" />
        </div>
        <p className="text-sm text-muted-foreground mt-2">Searching...</p>
      </div>
    );
  }

  if (!safeResults || safeResults.length === 0) {
    return (
      <div className="py-6 text-center bg-background">
        <p className="text-sm text-muted-foreground">No vulnerabilities found</p>
      </div>
    );
  }

  return (
    <div className="bg-background p-2">
      <div className="text-sm font-medium px-2 py-1.5 text-muted-foreground">
        Vulnerability Templates
      </div>
      {safeResults.map((item) => (
        <div
          key={item.id}
          onClick={() => onItemSelect(item)}
          className={cn(
            "flex items-center px-2 py-2 text-sm cursor-pointer rounded-md hover:bg-accent hover:text-accent-foreground",
            selectedItem?.id === item.id ? "bg-accent text-accent-foreground" : ""
          )}
        >
          <Check
            className={cn(
              "mr-2 h-4 w-4",
              selectedItem?.id === item.id ? "opacity-100" : "opacity-0"
            )}
          />
          <div className="flex flex-col">
            <span className="font-medium">{item.title}</span>
            {item.category && <span className="text-xs text-muted-foreground">{item.category}</span>}
          </div>
        </div>
      ))}
    </div>
  );
};

export default SearchResults;